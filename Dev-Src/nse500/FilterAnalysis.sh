DiffInCurPrcAnd44Mva=0

OptimizeDiffInCurPrcAnd44Mva()
{
    if [ $DiffInCurPrcAnd44Mva -ge 0 ] && [ $DiffInCurPrcAnd44Mva -le 7 ]
    then
        DiffInCurPrcAnd44Mva=5
    elif [ $DiffInCurPrcAnd44Mva -ge 8 ] && [ $DiffInCurPrcAnd44Mva -le 14 ]
    then
        DiffInCurPrcAnd44Mva=10
    elif [ $DiffInCurPrcAnd44Mva -ge 15 ] && [ $DiffInCurPrcAnd44Mva -le 21 ]
    then
        DiffInCurPrcAnd44Mva=15
    elif [ $DiffInCurPrcAnd44Mva -ge 22 ] && [ $DiffInCurPrcAnd44Mva -le 28 ]
    then
        DiffInCurPrcAnd44Mva=25    
    elif [ $DiffInCurPrcAnd44Mva -ge 29 ] && [ $DiffInCurPrcAnd44Mva -le 35 ]
    then
        DiffInCurPrcAnd44Mva=30
    elif [ $DiffInCurPrcAnd44Mva -ge 36 ] && [ $DiffInCurPrcAnd44Mva -le 42 ]
    then
        DiffInCurPrcAnd44Mva=35
    elif [ $DiffInCurPrcAnd44Mva -ge 43 ] && [ $DiffInCurPrcAnd44Mva -le 49 ]
    then
        DiffInCurPrcAnd44Mva=40
    elif [ $DiffInCurPrcAnd44Mva -ge 50 ] && [ $DiffInCurPrcAnd44Mva -le 56 ]
    then
        DiffInCurPrcAnd44Mva=50
    elif [ $DiffInCurPrcAnd44Mva -ge 57 ] && [ $DiffInCurPrcAnd44Mva -le 63 ]
    then
        DiffInCurPrcAnd44Mva=55
    elif [ $DiffInCurPrcAnd44Mva -ge 64 ] && [ $DiffInCurPrcAnd44Mva -le 70 ]
    then
        DiffInCurPrcAnd44Mva=60
    elif [ $DiffInCurPrcAnd44Mva -ge 71 ] && [ $DiffInCurPrcAnd44Mva -le 77 ]
    then
        DiffInCurPrcAnd44Mva=70
    elif [ $DiffInCurPrcAnd44Mva -ge 78 ] && [ $DiffInCurPrcAnd44Mva -le 84 ]
    then
        DiffInCurPrcAnd44Mva=80
    elif [ $DiffInCurPrcAnd44Mva -ge 85 ] && [ $DiffInCurPrcAnd44Mva -le 91 ]
    then
        DiffInCurPrcAnd44Mva=85
    elif [ $DiffInCurPrcAnd44Mva -ge 92 ] && [ $DiffInCurPrcAnd44Mva -le 98 ]
    then
        DiffInCurPrcAnd44Mva=90
    elif [ $DiffInCurPrcAnd44Mva -ge 99 ] && [ $DiffInCurPrcAnd44Mva -le 105 ]
    then
        DiffInCurPrcAnd44Mva=100
    elif [ $DiffInCurPrcAnd44Mva -ge 106 ] && [ $DiffInCurPrcAnd44Mva -le 112 ]
    then
        DiffInCurPrcAnd44Mva=105
    elif [ $DiffInCurPrcAnd44Mva -ge 113 ] && [ $DiffInCurPrcAnd44Mva -le 119 ]
    then
        DiffInCurPrcAnd44Mva=115
    elif [ $DiffInCurPrcAnd44Mva -ge 120 ] && [ $DiffInCurPrcAnd44Mva -le 126 ]
    then
        DiffInCurPrcAnd44Mva=120
    elif [ $DiffInCurPrcAnd44Mva -ge 127 ] && [ $DiffInCurPrcAnd44Mva -le 133 ]
    then
        DiffInCurPrcAnd44Mva=125
    elif [ $DiffInCurPrcAnd44Mva -ge 134 ] && [ $DiffInCurPrcAnd44Mva -le 140 ]
    then
        DiffInCurPrcAnd44Mva=135
    elif [ $DiffInCurPrcAnd44Mva -ge 141 ] && [ $DiffInCurPrcAnd44Mva -le 147 ]
    then
        DiffInCurPrcAnd44Mva=140
    elif [ $DiffInCurPrcAnd44Mva -lt 0 ] && [ $DiffInCurPrcAnd44Mva -ge -7 ]
    then
        DiffInCurPrcAnd44Mva=-5
    elif [ $DiffInCurPrcAnd44Mva -le -8 ] && [ $DiffInCurPrcAnd44Mva -ge -14 ]
    then
        DiffInCurPrcAnd44Mva=-10
    elif [ $DiffInCurPrcAnd44Mva -le -15 ] && [ $DiffInCurPrcAnd44Mva -ge -21 ]
    then
        DiffInCurPrcAnd44Mva=-15
    elif [ $DiffInCurPrcAnd44Mva -le -22 ] && [ $DiffInCurPrcAnd44Mva -ge -28 ]
    then
        DiffInCurPrcAnd44Mva=-25    
    elif [ $DiffInCurPrcAnd44Mva -le -29 ] && [ $DiffInCurPrcAnd44Mva -ge -35 ]
    then
        DiffInCurPrcAnd44Mva=-30
    elif [ $DiffInCurPrcAnd44Mva -le -36 ] && [ $DiffInCurPrcAnd44Mva -ge -42 ]
    then
        DiffInCurPrcAnd44Mva=-35
    elif [ $DiffInCurPrcAnd44Mva -le -43 ] && [ $DiffInCurPrcAnd44Mva -ge -49 ]
    then
        DiffInCurPrcAnd44Mva=-40
    elif [ $DiffInCurPrcAnd44Mva -le -50 ] && [ $DiffInCurPrcAnd44Mva -ge -56 ]
    then
        DiffInCurPrcAnd44Mva=-50
    elif [ $DiffInCurPrcAnd44Mva -le -57 ] && [ $DiffInCurPrcAnd44Mva -ge -63 ]
    then
        DiffInCurPrcAnd44Mva=-55
    elif [ $DiffInCurPrcAnd44Mva -le -64 ] && [ $DiffInCurPrcAnd44Mva -ge -70 ]
    then
        DiffInCurPrcAnd44Mva=-60
    elif [ $DiffInCurPrcAnd44Mva -le -71 ] && [ $DiffInCurPrcAnd44Mva -ge -77 ]
    then
        DiffInCurPrcAnd44Mva=-70
    elif [ $DiffInCurPrcAnd44Mva -le -78 ] && [ $DiffInCurPrcAnd44Mva -ge -84 ]
    then
        DiffInCurPrcAnd44Mva=-80
    elif [ $DiffInCurPrcAnd44Mva -le -85 ] && [ $DiffInCurPrcAnd44Mva -ge -91 ]
    then
        DiffInCurPrcAnd44Mva=-85
    elif [ $DiffInCurPrcAnd44Mva -le -92 ] && [ $DiffInCurPrcAnd44Mva -ge -98 ]
    then
        DiffInCurPrcAnd44Mva=-90
    elif [ $DiffInCurPrcAnd44Mva -le -99 ] && [ $DiffInCurPrcAnd44Mva -ge -105 ]
    then
        DiffInCurPrcAnd44Mva=-100
    elif [ $DiffInCurPrcAnd44Mva -le -106 ] && [ $DiffInCurPrcAnd44Mva -ge -112 ]
    then
        DiffInCurPrcAnd44Mva=-105
    elif [ $DiffInCurPrcAnd44Mva -le -113 ] && [ $DiffInCurPrcAnd44Mva -ge -119 ]
    then
        DiffInCurPrcAnd44Mva=-115
    elif [ $DiffInCurPrcAnd44Mva -le -120 ] && [ $DiffInCurPrcAnd44Mva -ge -126 ]
    then
        DiffInCurPrcAnd44Mva=-120
    elif [ $DiffInCurPrcAnd44Mva -le -127 ] && [ $DiffInCurPrcAnd44Mva -ge -133 ]
    then
        DiffInCurPrcAnd44Mva=-125
    elif [ $DiffInCurPrcAnd44Mva -le -134 ] && [ $DiffInCurPrcAnd44Mva -ge -140 ]
    then
        DiffInCurPrcAnd44Mva=-135
    elif [ $DiffInCurPrcAnd44Mva -le -141 ] && [ $DiffInCurPrcAnd44Mva -ge -147 ]
    then
        DiffInCurPrcAnd44Mva=-140
    fi
}


#This function remove equity data which curr mkt price is less than 100 or greater than 3500
FilterAnalysisStock()
{
    cd /home/rj1aditya/Dev/Scr/nse500/Data/Average/

    for data in `cat Analysis.csv`
    do
        CurrMktPrice=`echo $data | awk -F',' '{print $2}' | awk -F'.' '{print $1}'`
        if [ $CurrMktPrice -lt 3500 ] && [ $CurrMktPrice -gt 101 ]
        then
            echo $data >> RawFile
        fi
    done

    mv RawFile AnalysisFilt.csv
}

#This function compare the Current Mkt price from 44MVA and 200MVA, and make entries in the AnalysisFilt.csv
WatchList()
{
    cd /home/rj1aditya/Dev/Scr/nse500/Data/Average/
    for data in `cat AnalysisFilt.csv`
    do
        equityName=`echo $data | awk -F',' '{print $1}'`
        CurrMktPrice=`echo $data | awk -F',' '{print $2}'  | awk -F'.' '{print $1}'`
        MVA44=`echo $data | awk -F',' '{print $3}'  | awk -F'.' '{print $1}'`
        MVA200=`echo $data | awk -F',' '{print $4}'  | awk -F'.' '{print $1}'`
        if [ $MVA200 -lt $MVA44 ] && [ $CurrMktPrice -gt $MVA44 ] && [ $CurrMktPrice -gt $MVA200 ] 
        then
            RawFileName=RawFile1
        else
            RawFileName=RawFile2
        fi
        DiffInCurPrcAnd44Mva=`echo $CurrMktPrice - $MVA44 | bc`
        DiffInCurPrcAnd44Mvabkup="$DiffInCurPrcAnd44Mva"
        OptimizeDiffInCurPrcAnd44Mva
        diffIn44And200=`echo $MVA44 - $MVA200 | bc`
        echo "$equityName,$CurrMktPrice,$MVA44,$MVA200,$DiffInCurPrcAnd44Mva,$DiffInCurPrcAnd44Mvabkup,$diffIn44And200" >> $RawFileName
    done

    mv RawFile1 AnalysisFilt_CurMktPrc_Above_200_44.csv
    cp AnalysisFilt_CurMktPrc_Above_200_44.csv ./bkup/AnalysisFilt_CurMktPrc_Above_200_44_`date +%d%m%Y`.csv
    mv RawFile2 AnalysisFilt_CurMktPrc_Below_200_44.csv
    cp AnalysisFilt_CurMktPrc_Below_200_44.csv ./bkup/AnalysisFilt_CurMktPrc_Below_200_44_`date +%d%m%Y`.csv
}

main()
{
    FilterAnalysisStock
    WatchList
}

main